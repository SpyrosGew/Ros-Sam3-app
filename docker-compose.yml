version: "3.8"

services:

  # ================================================================
  # 1. REALSENSE NODE (PC1 / Laptop)
  # ================================================================
  realsense_node:
    profiles: ["pc1"]
    build:
      context: ./docker/realsense_node
    container_name: realsense_node
    restart: unless-stopped
    privileged: true
    network_mode: host
    devices:
      - /dev/bus/usb:/dev/bus/usb
    volumes:
      - /dev:/dev
    environment:
      - ZMQ_PUB_PORT=5555
    command: python3 /app/realsense_publisher.py


  # ================================================================
  # 2. GPU CLIENT (PC2)
  # ================================================================
  gpu_client:
    profiles: ["pc2"]
    build:
      context: ./docker/gpu_client
    container_name: gpu_client
    restart: unless-stopped
    network_mode: host
    environment:
      - ZMQ_SERVER_IP=10.100.55.12
      - ZMQ_SERVER_PORT=5555
    command: python3 /app/gpu_client.py
